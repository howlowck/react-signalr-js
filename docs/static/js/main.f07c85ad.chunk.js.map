{"version":3,"sources":["App.js","serviceWorker.js","index.js"],"names":["renderGroupMessages","groupJoined","members","userId","messages","className","map","_","key","style","background","color","padding","border","id","index","message","fontSize","App","props","connectEndpoint","useSelector","state","joinEndpoint","sendEndpoint","messagesEndpoint","connected","messageValue","groupNameValue","joined","dispatch","useDispatch","onSendFunc","onSendClick","onJoinFunc","onJoinClick","onConnectFunc","onConnectClick","onSubmit","evt","preventDefault","placeholder","value","onChange","type","endpoint","target","width","disabled","onClick","Boolean","window","location","hostname","match","defaultState","localStorage","getItem","shortid","generate","console","log","store","createStore","prev","action","setItem","groupName","fetchMessages","fetch","indexOf","then","res","json","ReactDOM","render","connection","signalR","withUrl","transport","WebSockets","build","on","data","newMember","start","info","connectionId","group","method","headers","body","JSON","stringify","messageData","targetGroupName","name","catch","err","document","getElementById","navigator","serviceWorker","ready","registration","unregister","error"],"mappings":"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","file":"static/js/main.f07c85ad.chunk.js","sourcesContent":["import React from 'react';\nimport { useSelector, useDispatch } from 'react-redux'\nimport './App.css';\n\n\nfunction App(props) {\n  const connectEndpoint = useSelector(state => state.connectEndpoint)\n  const joinEndpoint = useSelector(state => state.joinEndpoint)\n  const sendEndpoint = useSelector(state => state.sendEndpoint)\n  const messagesEndpoint = useSelector(state => state.messagesEndpoint)\n  const userId = useSelector(state => state.userId)\n  const messages = useSelector(state => state.messages)\n  const connected = useSelector(state => state.connected)\n  const messageValue = useSelector(state => state.messageValue)\n  const groupNameValue = useSelector(state => state.groupNameValue)\n  // const connectionId = useSelector(state => state.connectionId)\n  const groupJoined = useSelector(state => state.joined)\n  const members = useSelector(state => state.members)\n\n  const dispatch = useDispatch()\n  const onSendFunc = props.onSendClick\n  const onJoinFunc = props.onJoinClick\n  const onConnectFunc = props.onConnectClick\n  return (\n    <div >\n      <h3>Your UserId: {userId}</h3>\n      <hr></hr>\n      <h3>{connected ? 'Connected' : 'Connect'} to your SignalR Hub {connected ? '(Refresh to Disconnect)' : ''}</h3>\n      <form onSubmit={evt => evt.preventDefault()}>\n        <input placeholder=\"Connect Endpoint ie. {fnx-url}/api{?code=key} (don't include /negotiate)\" value={connectEndpoint} onChange={(evt) => dispatch({ type: 'SET_CONNECT_ENDPOINT', endpoint: evt.target.value })} style={{width: 400}} disabled={connected} /><br/>\n        <input placeholder=\"Join Endpoint ie. {fnx-url}/api/addToGroup{?code=key}\" value={joinEndpoint} onChange={(evt) => dispatch({ type: 'SET_JOIN_ENDPOINT', endpoint: evt.target.value })} style={{width: 400}} disabled={connected}/><br />\n        <input placeholder=\"Send Endpoint ie. {fnx-url}/api/messages{?code=key}\" value={sendEndpoint} onChange={(evt) => dispatch({ type: 'SET_SEND_ENDPOINT', endpoint: evt.target.value })} style={{width: 400}} disabled={connected}/><br />\n        <input placeholder=\"Messages Endpoint ie. {fnx-url}/getMessages{?code=key}\" value={messagesEndpoint} onChange={(evt) => dispatch({ type: 'SET_MESSAGES_ENDPOINT', endpoint: evt.target.value })} style={{width: 400}} disabled={connected} /><br/>\n        <button onClick={() => { onConnectFunc(connectEndpoint, userId) }} disabled={!(connectEndpoint && joinEndpoint && sendEndpoint) || connected}>{connected ? 'Connected' : 'Connect'}</button>\n      </form>\n      <br />\n      Join Group: \n      <form onSubmit={evt => evt.preventDefault()}>\n        <input value={groupNameValue} onChange={(evt) => dispatch({ type: 'SET_GROUP_VALUE', value: evt.target.value })} disabled={groupJoined} />\n        <button onClick={() => { onJoinFunc(joinEndpoint, messagesEndpoint, groupNameValue, userId) }} disabled={!connected || groupJoined}>Join</button>\n      </form>\n      <br />\n      {groupJoined? `Send Message To ${groupJoined}:`:`Send:`}\n      <form onSubmit={evt => evt.preventDefault()}>\n        <input value={messageValue} onChange={(evt) => dispatch({ type: 'SET_MESSAGE', value: evt.target.value })} /> \n        <button onClick={() => { onSendFunc(sendEndpoint, groupNameValue, messageValue); dispatch({ type: 'SET_MESSAGE', value: '' }) }} disabled={!groupJoined}>Send</button>\n      </form>\n      <br /><br />\n      {renderGroupMessages(groupJoined, members, userId, messages)}\n    </div>\n  );\n}\n\nconst renderGroupMessages = (groupJoined, members, userId, messages) => {\n  if (groupJoined){\n    return <div className=\"groupMessages\">\n        <h3>\"{groupJoined}\" Group</h3>\n        <h4>Members</h4>\n        <div className=\"members\">\n          {members.map(_ => {\n            if (_ === userId) {\n              return <span key={_} style={{background: 'blue', color: 'white', padding: 5}}>You</span>\n            } else {\n              return <span key={_} style={{padding: 5, border: '1px gray solid'}}>{_}</span>\n            }\n          })}\n        </div>\n        <h4>Messages</h4>\n        <div id=\"messages\">\n          {messages.map((_, index) => {\n            return (\n              <div key={index}>{_.message} <span style={{fontSize: 13}}> ({userId === _.userId ? `from ME`: `from ${_.userId}`})</span></div>\n            )\n          })}\n        </div>\n      </div>\n  }\n  return ''\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport * as serviceWorker from './serviceWorker';\r\nimport * as signalR from '@microsoft/signalr'\r\nimport { Provider } from 'react-redux'\r\nimport { createStore } from 'redux'\r\nimport shortid from 'shortid'\r\n\r\nconst defaultState = {\r\n  connectEndpoint: localStorage.getItem('react-signalr/connectEndpoint') || '',\r\n  joinEndpoint: localStorage.getItem('react-signalr/joinEndpoint') || '',\r\n  sendEndpoint: localStorage.getItem('react-signalr/sendEndpoint') || '',\r\n  messagesEndpoint: localStorage.getItem('react-signalr/messagesEndpoint') || '',\r\n  userId: '',\r\n  groupNameValue: '', \r\n  messageValue: '', \r\n  connected: false,\r\n  groupJoined: null,\r\n  // connectionId: null,\r\n  messages: [],\r\n  members: []\r\n}\r\n\r\nconst userId = shortid.generate();\r\nconsole.log('userId:', userId)\r\n\r\nconst store = createStore((prev = defaultState, action ) => {\r\n  if (action.type === 'SET_CONNECT_ENDPOINT') {\r\n    localStorage.setItem('react-signalr/connectEndpoint', action.endpoint)\r\n    return {\r\n      ...prev,\r\n      connectEndpoint: action.endpoint\r\n    } \r\n  }\r\n\r\n  if (action.type === 'SET_JOIN_ENDPOINT') {\r\n    localStorage.setItem('react-signalr/joinEndpoint', action.endpoint)\r\n    return {\r\n      ...prev,\r\n      joinEndpoint: action.endpoint\r\n    } \r\n  }\r\n\r\n  if (action.type === 'SET_SEND_ENDPOINT') {\r\n    localStorage.setItem('react-signalr/sendEndpoint', action.endpoint)\r\n    return {\r\n      ...prev,\r\n      sendEndpoint: action.endpoint\r\n    } \r\n  }\r\n\r\n  if (action.type === 'SET_MESSAGES_ENDPOINT') {\r\n    localStorage.setItem('react-signalr/messagesEndpoint', action.endpoint)\r\n    return {\r\n      ...prev,\r\n      messagesEndpoint: action.endpoint\r\n    } \r\n  }\r\n\r\n  if (action.type === 'SET_USER_ID') {\r\n    return {\r\n      ...prev,\r\n      userId: action.value\r\n    }\r\n  }\r\n\r\n  if (action.type === 'SET_GROUP_VALUE') {\r\n    return {\r\n      ...prev,\r\n      groupNameValue: action.value\r\n    }\r\n  }\r\n\r\n  if (action.type === 'SET_MESSAGE') {\r\n    return {\r\n      ...prev,\r\n      messageValue: action.value\r\n    }\r\n  }\r\n\r\n  if (action.type === 'SIGNALR_CONNECTED') {\r\n    return {\r\n      ...prev,\r\n      connected: true\r\n      // connectionId: action.connectionId\r\n    }\r\n  }\r\n\r\n  if (action.type === 'GROUP_JOINED') {\r\n    return {\r\n      ...prev,\r\n      joined: action.groupName\r\n    }\r\n  }\r\n\r\n  if (action.type === 'NEW_MESSAGE') {\r\n    return {\r\n      ...prev,\r\n      messages: [...prev.messages, action.message]\r\n    }\r\n  }\r\n\r\n  if (action.type === 'SET_MEMBERS') {\r\n    return {\r\n      ...prev,\r\n      members: action.members\r\n    }\r\n  }\r\n\r\n  if (action.type === 'SET_MESSAGES') {\r\n    return {\r\n      ...prev,\r\n      messages: action.messages\r\n    }\r\n  }\r\n\r\n  return prev\r\n})\r\n\r\nstore.dispatch({type: 'SET_USER_ID', value: userId})\r\n\r\nconst connectHub = (connectEndpoint, userId) => {\r\n  let connection = new signalR.HubConnectionBuilder()\r\n  .withUrl(`${connectEndpoint}${connectEndpoint.indexOf('?') < 0 ? '?' : '&'}userId=${userId}`, {\r\n    transport: signalR.HttpTransportType.WebSockets\r\n  })\r\n  .build();\r\n\r\n  connection.on(\"group:newMessage\", data => {\r\n    console.log('group:newMessage payload', data)\r\n    store.dispatch({type: 'NEW_MESSAGE', message: data})\r\n  });\r\n\r\n  connection.on(\"group:memberJoined\", data => {\r\n    console.log('group:memberJoined payload', data)\r\n    if (data.newMember === userId) {\r\n      store.dispatch({type: 'GROUP_JOINED', groupName: data.groupName})\r\n    }\r\n    store.dispatch({type: 'SET_MEMBERS', groupName: data.groupName, members: data.members})\r\n  });\r\n\r\n  connection.on(\"group:memberLeft\", data => {\r\n    console.log('group:memberLeft payload', data)\r\n    store.dispatch({type: 'SET_MEMBERS', groupName: data.groupName, members: data.members})\r\n  });\r\n\r\n  connection.on(\"global:newMessage\", data => {\r\n    console.log('global:newMessage payload', data)\r\n  });\r\n\r\n  connection.on(\"user:newMessage\", data => {\r\n    console.log('user:newMessage payload', data)\r\n  });\r\n\r\n  connection.on(\"global:memberLeft\", data => {\r\n    console.log('global:memberLeft payload', data)\r\n  });\r\n\r\n  connection\r\n  .start()\r\n  .then((info) => {\r\n    console.log('connectionId:', connection.connectionId)\r\n    const { connectionId } = connection\r\n    console.log('invoking send')\r\n    console.log('connected to signalR')\r\n    store.dispatch({ type: 'SIGNALR_CONNECTED', connectionId })\r\n    // sendMessage(`hello from initial load ${Date().toString()}`)\r\n  });\r\n}\r\n\r\n\r\nconst sendMessage = (sendEndpoint, group, message) => {\r\n  return fetch(`${sendEndpoint}${sendEndpoint.indexOf('?') < 0 ? '?' : '&'}userId=${userId}`, {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json'\r\n    },\r\n    body: JSON.stringify({\r\n      messageData: {message, userId},\r\n      // userId,\r\n      targetGroupName: group\r\n    })\r\n  })\r\n}\r\n\r\nconst joinGroup = (joinEndpoint, messagesEndpoint, name, userId) => {\r\n  console.log('joining group...')\r\n  return fetch(`${joinEndpoint}${joinEndpoint.indexOf('?') < 0 ? '?' : '&'}groupName=${name}&userId=${userId}`, {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json'\r\n    },\r\n    body: JSON.stringify({\r\n      groupName: name,\r\n      userId\r\n    })\r\n  })\r\n  .catch((err) => {console.log(err)})\r\n  .then(() => fetchMessages(messagesEndpoint, name))\r\n  .then(messages => {\r\n    store.dispatch({type: 'SET_MESSAGES', messages})\r\n  })\r\n}\r\n\r\nconst fetchMessages = (messagesEndpoint, groupName) => {\r\n  return fetch(`${messagesEndpoint}${messagesEndpoint.indexOf('?') < 0 ? '?' : '&'}groupName=${groupName}`)\r\n    .then(res => res.json())\r\n}\r\n\r\n\r\nReactDOM.render(\r\n  <Provider store={store}>\r\n    <App onConnectClick={connectHub} onSendClick={sendMessage} onJoinClick={joinGroup} />\r\n  </Provider>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n"],"sourceRoot":""}